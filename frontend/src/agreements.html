<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Договоры</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="container">
    <h1>Управление договорами</h1>
    <button onclick="location.href='index.html'">← Назад</button>

    <!-- Создание договора -->
    <div class="form-section">
        <h2>Создать договор</h2>
        <form id="createAgreementForm">
            <div class="form-group">
                <label>Ключ идемпотентности:</label>
                <input type="text" name="key" required>
            </div>
            <div class="form-group">
                <label>Сумма долга:</label>
                <input type="number" step="0.01" name="originalDebtSum" required>
            </div>
            <div class="form-group">
                <label>Текущий остаток:</label>
                <input type="number" step="0.01" name="actualDebtSum" required>
            </div>
            <div class="form-group">
                <label>Дата подписания:</label>
                <input type="date" name="agreementStartDate" required>
            </div>
            <div class="form-group">
                <label>Банк-кредитор:</label>
                <input type="text" name="transferor" required>
            </div>

            <!-- Секция для заемщиков -->
            <div class="debtor-section">
                <h3>Заемщики</h3>
                <div id="debtorsContainer">
                    <!-- Первый заемщик -->
                    <div class="debtor-form" id="debtor-0">
                        <div class="section-title">Заемщик 1</div>
                        <button type="button" onclick="removeDebtor(0)" style="float: right; background: #dc3545;">× Удалить</button>
                        <div class="form-group">
                            <label>Имя:</label>
                            <input type="text" name="debtors[0].firstname" required>
                        </div>
                        <div class="form-group">
                            <label>Фамилия:</label>
                            <input type="text" name="debtors[0].lastname" required>
                        </div>
                        <div class="form-group">
                            <label>Отчество:</label>
                            <input type="text" name="debtors[0].patronymic">
                        </div>
                        <div class="form-group">
                            <label>Дата рождения:</label>
                            <input type="date" name="debtors[0].birthday" required>
                        </div>
                        <div class="form-group">
                            <label>Пол:</label>
                            <select name="debtors[0].gender" required>
                                <option value="male">Мужской</option>
                                <option value="female">Женский</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Роль:</label>
                            <select name="debtors[0].role" required>
                                <option value="co-debtor">Созаемщик</option>
                                <option value="single debtor">Единственный заемщик</option>
                                <option value="guarantor">Поручитель</option>
                                <option value="charger">Залогодатель</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Телефон:</label>
                            <input type="tel" name="debtors[0].phoneNumber">
                        </div>

                        <!-- Адреса заемщика -->
                        <div class="address-section">
                            <h4>Адреса <button type="button" onclick="addAddress(0)" style="background: #28a745; padding: 2px 8px;">+ Добавить адрес</button></h4>
                            <div id="addresses-0">
                                <div class="address-form" id="address-0-0">
                                    <button type="button" onclick="removeAddress(0, 0)" style="float: right; background: #dc3545; padding: 2px 8px;">×</button>
                                    <div class="form-group">
                                        <label>Тип адреса:</label>
                                        <select name="debtors[0].addressDTOs[0].addressStatus" required>
                                            <option value="registration">Прописка</option>
                                            <option value="residential">Проживание</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Страна:</label>
                                        <input type="text" name="debtors[0].addressDTOs[0].country" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Город:</label>
                                        <input type="text" name="debtors[0].addressDTOs[0].city" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Улица:</label>
                                        <input type="text" name="debtors[0].addressDTOs[0].street" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Дом:</label>
                                        <input type="text" name="debtors[0].addressDTOs[0].house" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Квартира:</label>
                                        <input type="text" name="debtors[0].addressDTOs[0].apartment">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Документы заемщика -->
                        <div class="document-section">
                            <h4>Документы <button type="button" onclick="addDocument(0)" style="background: #28a745; padding: 2px 8px;">+ Добавить документ</button></h4>
                            <div id="documents-0">
                                <div class="document-form" id="document-0-0">
                                    <button type="button" onclick="removeDocument(0, 0)" style="float: right; background: #dc3545; padding: 2px 8px;">×</button>
                                    <div class="form-group">
                                        <label>Тип документа:</label>
                                        <select name="debtors[0].documentDTOs[0].documentType" required>
                                            <option value="NATIONAL_PASSPORT">Паспорт РФ</option>
                                            <option value="INTERNATIONAL_PASSPORT">Заграничный паспорт</option>
                                            <option value="DRIVER_LICENSE">Водительское удостоверение</option>
                                            <option value="INN">ИНН</option>
                                            <option value="SNILS">СНИЛС</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Номер документа:</label>
                                        <input type="text" name="debtors[0].documentDTOs[0].documentNumber" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Дата выдачи:</label>
                                        <input type="date" name="debtors[0].documentDTOs[0].issueDate" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="button" onclick="addDebtor()">+ Добавить еще заемщика</button>
            </div>

            <button type="button" onclick="createAgreement()">Создать договор</button>
        </form>
    </div>

    <!-- Получение договора -->
    <div class="form-section">
        <h2>Получить договор</h2>
        <form id="getAgreementForm">
            <div class="form-group">
                <label>ID договора:</label>
                <input type="number" name="agreementId" required>
            </div>
            <button type="button" onclick="getAgreement()">Получить</button>
        </form>
    </div>

    <!-- Обновление статуса -->
    <div class="form-section">
        <h2>Обновить статус</h2>
        <form id="updateStatusForm">
            <div class="form-group">
                <label>ID договора:</label>
                <input type="number" name="agreementId" required>
            </div>
            <div class="form-group">
                <label>Статус:</label>
                <select name="status" required>
                    <option value="active">Active</option>
                    <option value="paid">Paid</option>
                </select>
            </div>
            <button type="button" onclick="updateAgreementStatus()">Обновить статус</button>
        </form>
    </div>

    <!-- Удаление договора -->
    <div class="form-section">
        <h2>Удалить договор</h2>
        <form id="deleteAgreementForm">
            <div class="form-group">
                <label>ID договора:</label>
                <input type="number" name="agreementId" required>
            </div>
            <button type="button" onclick="deleteAgreement()">Удалить</button>
        </form>
    </div>

    <div id="agreementResult" class="result"></div>
</div>

<script src="js/api.js"></script>
<script src="js/agreements.js"></script>
</body>
</html>